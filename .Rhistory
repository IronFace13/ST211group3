# set up
library(dplyr)
library(tidyr)
library(readr)
library(lubridate)
library(arm)
library(tidyselect)
library(ggplot2)
# set up
library(dplyr)
library(tidyr)
library(readr)
library(lubridate)
library(arm)
library(tidyselect)
library(ggplot2)
# Data Loading
data<-read.csv("data/RWNS_final.csv", header=TRUE,stringsAsFactors=TRUE)
View(data)
colnames(data)
typeof(data$homework)
ggplot(data, aes(x = homework, y = ks4score)) +
geom_point(alpha=0.2, size=3, color="lightblue", stroke=1) +
geom_smooth(method = "lm",
se = FALSE) +
theme_minimal() +
labs(title = "Scatter Plot of Homework vs. GCSE Scores with Fitted Line",
x = "Homework (in evenings)",
y = "GCSE Scores") +
theme(axis.title.x = element_text(size = rel(1.4)),
axis.text.x = element_text(size = rel(1.2)),
axis.title.y = element_text(size = rel(1.4)),
axis.text.y = element_text(size = rel(1.2)),
plot.title = element_text(size = rel(1.6), face = "bold",
hjust = 0.5))
ggplot(data, aes(x = IDACI_n, y = k4score)) +
geom_point(alpha=0.2, size=3, color="lightblue", stroke=1) +
geom_smooth(method = "lm",
se = FALSE) +
theme_minimal() +
labs(title = "Scatter Plot of Deprivation vs GCSE Scores with Fitted Line",
x = "Index of Deprivation",
y = "GCSE Scores") +
theme(axis.title.x = element_text(size = rel(1.4)),
axis.text.x = element_text(size = rel(1.2)),
axis.title.y = element_text(size = rel(1.4)),
axis.text.y = element_text(size = rel(1.2)),
plot.title = element_text(size = rel(1.6), face = "bold",
hjust = 0.5))
ggplot(data, aes(x = IDACI_n, y = ks4score)) +
geom_point(alpha=0.2, size=3, color="lightblue", stroke=1) +
geom_smooth(method = "lm",
se = FALSE) +
theme_minimal() +
labs(title = "Scatter Plot of Deprivation vs GCSE Scores with Fitted Line",
x = "Index of Deprivation",
y = "GCSE Scores") +
theme(axis.title.x = element_text(size = rel(1.4)),
axis.text.x = element_text(size = rel(1.2)),
axis.title.y = element_text(size = rel(1.4)),
axis.text.y = element_text(size = rel(1.2)),
plot.title = element_text(size = rel(1.6), face = "bold",
hjust = 0.5))
# Simple linear regression model
IDACI_lm <- lm(ks4score ~ IDACI_n, data = data)
display(IDACI_lm)
# Simple linear regression model
IDACI_lm <- lm(ks4score ~ IDACI_n, data = data)
summary(IDACI_lm)
ggplot(data, aes(x = k3en, y = ks4score)) +
geom_point(alpha=0.2, size=3, color="lightblue", stroke=1) +
geom_smooth(method = "lm",
se = FALSE) +
theme_minimal() +
labs(title = "Scatter Plot of English Level vs GCSE Scores with Fitted Line",
x = "English Level",
y = "GCSE Scores") +
theme(axis.title.x = element_text(size = rel(1.4)),
axis.text.x = element_text(size = rel(1.2)),
axis.title.y = element_text(size = rel(1.4)),
axis.text.y = element_text(size = rel(1.2)),
plot.title = element_text(size = rel(1.6), face = "bold",
hjust = 0.5))
## ----message=FALSE-------------------------------------------------------
library(arm)
## ------------------------------------------------------------------------
first.dat<-read.csv("age_hourpay.csv",header = TRUE) # it's a data frame
wrong.dat<-read.table("age_hourpay.csv",header=TRUE) # it's a raw table with only one column
setwd("~/Desktop/LSE/Year2/ST211/week2")
## ------------------------------------------------------------------------
first.dat<-read.csv("age_hourpay.csv",header = TRUE) # it's a data frame
wrong.dat<-read.table("age_hourpay.csv",header=TRUE) # it's a raw table with only one column
## ----echo=FALSE, out.width = '70%'---------------------------------------
knitr::include_graphics("EnvironmentWkshp2.png")
## ------------------------------------------------------------------------
dim(first.dat)
first.dat[55,2]
## ------------------------------------------------------------------------
colnames(first.dat)
head(first.dat)
head(first.dat, 3)
head(wrong.dat)
tail(first.dat)
## ---- results='hide'-----------------------------------------------------
summary(first.dat) # inc: min, 1stQ, median, mean, 3rdQ, max
## you can also use single means calculation
with(first.dat, mean(gender==0))
colMeans(first.dat)
aggregate(first.dat[,-1], first.dat[1], mean)
## two ways of specifying age column
first.dat$age
first.dat[,2]
head(first.dat[,2])
## adding conditions
head(first.dat$age<18) # gives out boolean results
which(first.dat$age<18) # gives out the values that meet the condition
## ------------------------------------------------------------------------
length(which(first.dat$age<18))
## you can create a table which satisfy the condition
under18<-first.dat[which(first.dat$age<18),]
table(under18$gender)
## three ways to extract a subset from the dataset
over18<-first.dat[which(first.dat$age>=18),]
dim(over18)
over18<-first.dat[first.dat$age>=18,]
dim(over18)
over18<-subset(first.dat, age>=18)
dim(over18)
write.csv(over18, "Over18_age_hourpay,csv", row.names = FALSE)
second.dat<-subset(first.dat, (age>=18 & hourpay<=50))
## simple plots by using its own pack
with(over18, plot(age,hourpay))
with(over18, plot(age,log(hourpay))) # log() value can exclude outliers
plot(over18$age, log(over18$hourpay))
## ------------------------------------------------------------------------
library(ggplot2)
library(gridExtra)
## ----fig.height=4, fig.width=8-------------------------------------------
p1<-ggplot(over18, aes(x=age, y=log(hourpay),colour=factor(gender)))
# point plot
p1<- p1 + geom_point(size=0.5,aes(colour=factor(gender)))
# set the colour to grey
## p1<- p1 +scale_colour_grey(start = 0.1, end = 0.6)  + theme_bw()
# set the scale of the plot
p1<- p1+ theme(legend.position = c(0.35,0.9), legend.direction = "horizontal")
# set the plot title
p1<- p1+ ggtitle("log(Hourly pay) by age and gender")
# add a best fit line
p1 <- p1+ geom_smooth(method="lm",colour="red", fill=NA)
p1
p2<-ggplot(over18, aes(x=age, y=log(hourpay)))
p2<- p2 + geom_jitter(size=0.5,aes(colour=factor(gender)))
# p2<-  p2 + scale_colour_grey(start = 0.1, end = .6)  + theme_bw()
p2<- p2+ theme(legend.position = "none")
p2<- p2+ ggtitle("log(Hourly pay) by age and gender")
grid.arrange(p1,p2,ncol=2) # show the two plots at the same time
## ------------------------------------------------------------------------
summary(over18)
colMeans(over18)
head(rowSums(over18))
rm(list=ls())
setwd("~/")
setwd("~/Desktop/LSE/Year2/ST211/week3")
# Question1
library(arm)
library(ggplot2)
carsales.dat<-read.csv("carsales.csv", header=TRUE,stringsAsFactors=TRUE)
p1<-ggplot(data=carsales.dat, aes(x=Age, y=Price))+geom_point()
p1<-p1+xlim(0,11)+ylim(0,140)
p1
#Question2
carsales.lm<-lm(Price~Age, data=carsales.dat)
display(carsales.lm)
#Question3
bankemp.dat<-read.csv("bankMLR.csv", header=TRUE,stringsAsFactors=TRUE)
#Question5
p2<-ggplot(data=bankemp.dat, aes(x=Gender==1,y=Salary))+geom_boxplot()
p2
IDACI_g<-ggplot(data, aes(x = IDACI_n, y = ks4score)) +
geom_point(alpha=0.2, size=3, color="lightblue", stroke=1) +
geom_smooth(method = "lm",
se = FALSE) +
theme_minimal() +
labs(title = "Scatter Plot of Deprivation vs GCSE Scores with Fitted Line",
x = "Index of Deprivation",
y = "GCSE Scores") +
theme(axis.title.x = element_text(size = rel(1.4)),
axis.text.x = element_text(size = rel(1.2)),
axis.title.y = element_text(size = rel(1.4)),
axis.text.y = element_text(size = rel(1.2)),
plot.title = element_text(size = rel(1.6), face = "bold",
hjust = 0.5))
rm(list=ls())
setwd("~/Desktop/LSE/Year2/ST211/ST211group3")
# set up
library(dplyr)
library(tidyr)
library(readr)
library(lubridate)
library(arm)
library(tidyselect)
library(ggplot2)
# Data Loading
data<-read.csv("data/RWNS_final.csv", header=TRUE,stringsAsFactors=TRUE)
p2<-ggplot(data=bankemp.dat, aes(x=Gender==1,y=Salary))+geom_boxplot()
IDACI_g<-ggplot(data, aes(x = IDACI_n, y = ks4score)) +
geom_point(alpha=0.2, size=3, color="lightblue", stroke=1) +
geom_smooth(method = "lm",
se = FALSE) +
theme_minimal() +
labs(title = "Scatter Plot of Deprivation vs GCSE Scores with Fitted Line",
x = "Index of Deprivation",
y = "GCSE Scores") +
theme(axis.title.x = element_text(size = rel(1.4)),
axis.text.x = element_text(size = rel(1.2)),
axis.title.y = element_text(size = rel(1.4)),
axis.text.y = element_text(size = rel(1.2)),
plot.title = element_text(size = rel(1.6), face = "bold",
hjust = 0.5))
IDACI_g
fiveac_g<-ggplot(data=data, aes(x=fiveac,y=ks4score))+geom_boxplot()
fiveac_g
IDACI_g<-ggplot(data, aes(x = IDACI_n, y = ks4score)) +
geom_point(alpha=0.2, size=3, color="lightblue", stroke=1) +
geom_smooth(method = "lm",
se = FALSE) +
theme_minimal() +
labs(title = "Scatter Plot of Deprivation vs GCSE Scores with Fitted Line",
x = "Index of Deprivation",
y = "GCSE Scores")
IDACI_g
fiveac_g<-ggplot(data=data, aes(x=fiveac,y=ks4score)) +
geom_boxplot() +
labels(title="Boxplot of 5 A*-C Subjects vs GCSE Scores",
x="5 A*-C Subjects",
y="GCSE Scores")
fiveac_g<-ggplot(data=data, aes(x=fiveac,y=ks4score)) +
geom_boxplot() +
labs(title="Boxplot of 5 A*-C Subjects vs GCSE Scores",
x="5 A*-C Subjects",
y="GCSE Scores")
fiveac_g
fiveac_lm <- lm(ks4score ~ fiveac, data = data)
summary(fiveac_lm)
fiveem_lm <- lm(ks4score ~ fiveem, data = data)
summary(fiveem_lm)
fiveem_g<-ggplot(data=data, aes(x=fiveem,y=ks4score)) +
geom_boxplot() +
labs(title="Boxplot of 5 A*-C Subjects vs GCSE Scores",
x="5 A*-C Subjects (including English and Maths)",
y="GCSE Scores")
fiveem_g
rm(list=ls())
# Data Loading
data<-read.csv("data/RWNS_final.csv", header=TRUE,stringsAsFactors=TRUE)
fiveem_g<-ggplot(data=data, aes(x=fiveem,y=ks4score)) +
geom_boxplot() +
labs(title="Boxplot of 5 A*-C Subjects vs GCSE Scores",
x="5 A*-C Subjects (including English and Maths)",
y="GCSE Scores")
fiveem_g
fiveac_lm <- lm(ks4score ~ fiveac, data = data)
summary(fiveac_lm)
fiveem_lm <- lm(ks4score ~ fiveem, data = data)
summary(fiveem_lm)
fiveac_g<-ggplot(data=data, aes(x=fiveac,y=ks4score)) +
geom_boxplot() +
labs(title="Boxplot of 5 A*-C Subjects vs GCSE Scores",
x="5 A*-C Subjects",
y="GCSE Scores")
fiveac_g
fiveac_lm <- lm(ks4score ~ fiveac, data = data)
display(fiveac_lm)
fiveem_lm <- lm(ks4score ~ fiveem, data = data)
display(fiveem_lm)
house_g<-ggplot(data=data, aes(x=house,y=ks4score)) +
geom_boxplot() +
labs(title="Boxplot of Housing Status vs GCSE Scores",
x="Housing Status",
y="GCSE Scores")
house_g
# Simple linear regression model
IDACI_lm <- lm(ks4score ~ IDACI_n, data = data)
summary(IDACI_lm$coefficients)
# Simple linear regression model
IDACI_lm <- lm(ks4score ~ IDACI_n, data = data)
display(IDACI_lm$coefficients)
# Simple linear regression model
IDACI_lm <- lm(ks4score ~ IDACI_n, data = data)
summary(IDACI_lm)
house_g<-ggplot(data=data, aes(x=house,y=ks4score)) +
geom_boxplot() +
labs(title="Boxplot of Housing Status vs GCSE Scores",
x="Housing Status",
y="GCSE Scores")
house_g
house_IDACI_g<-ggplot(data=data, aes(x=house,y=IDACI_n)) +
geom_boxplot() +
labs(title="Boxplot of Housing Status vs Deprivation Index",
x="Housing Status",
y="Deprivation Index")
house_IDACI_g
